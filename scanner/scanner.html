<!DOCTYPE html>
<html>

<head>
  <meta charset="utf-8">
  <meta name="author" content="fR0DDY">
  <title>Code Scanner Demo</title>
  <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.1.3/css/bootstrap.min.css" integrity="sha384-MCw98/SFnGE8fJT3GXwEOngsV7Zt27NXFoaoApmYm81iuXoPkFOJwJ8ERdknLPMO"
    crossorigin="anonymous">
  <link rel="stylesheet" href="../css/app.css">
  <script type="text/javascript" src="js/instascan.min.js"></script>
  <style type="text/css">
    #shade,
    #modal {
      display: none;
    }

    #shade {
      position: fixed;
      z-index: 100;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
    }

    #modal {
      position: fixed;
      z-index: 101;
      top: 33%;
      left: 25%;
      width: 50%;
    }

    #shade {
      background: silver;
      opacity: 0.5;
      filter: alpha(opacity=50);
    }
  </style>
</head>

<body style="padding-top: 0px;">
  <div class="navbar navbar-inverse navbar-fixed-top app-nav">
    <div class="container">
      <div class="navbar-header">
        <a href="#" class="navbar-brand">Code Scanner Demo</a>
      </div>
    </div>
  </div>
  <div class="container-fluid">
    <div class="row-fluid">
      <div class="col-sm-12">
        <video id="preview" style="width: 100%"></video>
      </div>
    </div>
    <div id="modal" title="Flow">
      <p>Image:</p>
      <img id="image" src="./img/KBC_Default.png" alt="Flow Image" />
    </div>
  </div>
  <script type="text/javascript">
    var modal = document.getElementById('modal');
    var shade = document.getElementById('shade');
    let scanner = new Instascan.Scanner({
      video: document.getElementById('preview'),
      mirror: false,
      refractoryPeriod: 1000,
    });
    scanner.addListener('scan', function (content) {
      console.log(content);
      if (content === 'Test1') {
        document.getElementById('image').src = './img/K1.png';
        modal.style.display = 'block';
      } else if (content === 'Test2') {
        document.getElementById('image').src = './img/K2.png';
        modal.style.display = shade.style.display = 'block';
      } else if (content === 'Test3') {
        document.getElementById('image').src = './img/K3.png';
        modal.style.display = shade.style.display = 'block';
      } else if (content === 'Test4') {
        document.getElementById('image').src = './img/K4.png';
        modal.style.display = shade.style.display = 'block';
      } else if (content === 'Test5') {
        document.getElementById('image').src = './img/K5.png';
        modal.style.display = shade.style.display = 'block';
      } else {
        document.getElementById('image').src = './img/KBC_Default.png';
        modal.style.display = shade.style.display = 'none';
      }
    });
    Instascan.Camera.getCameras().then(function (cameras) {
      if (cameras.length > 1) {
        scanner.start(cameras[1]);
      } else if (cameras.length > 0) {
        scanner.start(cameras[0]);
      } else {
        console.error('No cameras found.');
      }
    }).catch(function (e) {
      console.error(e);
    });
  </script>
</body>

</html>